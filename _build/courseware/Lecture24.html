---
redirect_from:
  - "/courseware/lecture24"
interact_link: content/courseware/Lecture24.ipynb
kernel_name: python3
kernel_path: content/courseware
has_widgets: false
title: |-
  Land-Ocean contrasts under climate change
pagenum: 27
prev_page:
  url: /courseware/Lecture23.html
next_page:
  url: /courseware/Lecture25.html
suffix: .ipynb
search: delta land frac ocean humidity qo ql warming surface q relative temperature air specific moisture gamma amplification d tau org theory journals jcli byrne ogorman hl climate change constraint boundary clim ametsoc ho changes simple doi factor lv l v dynamic pnas trends tl where j moist cp layer ft align alpha under content lines terms free constraints above horizontal mixing left right approx differences img src www large width landocean using equilibrium equiv contrast t moistening budget el lambdal influence overline gives well rl albany global average not f b anomalies averaged best asterisks also estimated error directly following

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Land-Ocean contrasts under climate change</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-recent-tweet-that-caught-my-attention...">A recent tweet that caught my attention...<a class="anchor-link" href="#A-recent-tweet-that-caught-my-attention..."> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%HTML</span>
<span class="p">&lt;</span><span class="nt">blockquote</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;twitter-tweet&quot;</span> <span class="na">data-lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;&lt;</span><span class="nt">p</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span> <span class="na">dir</span><span class="o">=</span><span class="s">&quot;ltr&quot;</span><span class="p">&gt;</span>actual trends <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://t.co/abnDJGeawr&quot;</span><span class="p">&gt;</span>pic.twitter.com/abnDJGeawr<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span><span class="ni">&amp;mdash;</span> Gavin Schmidt (@ClimateOfGavin) <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://twitter.com/ClimateOfGavin/status/1117136233409536000?ref_src=twsrc%5Etfw&quot;</span><span class="p">&gt;</span>April 13, 2019<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">blockquote</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://platform.twitter.com/widgets.js&quot;</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">actual trends <a href="https://t.co/abnDJGeawr">pic.twitter.com/abnDJGeawr</a></p>&mdash; Gavin Schmidt (@ClimateOfGavin) <a href="https://twitter.com/ClimateOfGavin/status/1117136233409536000?ref_src=twsrc%5Etfw">April 13, 2019</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> 

</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Statistics such as the global average or zonal average temperature do not tell the whole story about climate change!</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Some-observational-results-on-land-ocean-warming-differences-from-a-recent-paper">Some observational results on land-ocean warming differences from a recent paper<a class="anchor-link" href="#Some-observational-results-on-land-ocean-warming-differences-from-a-recent-paper"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src='https://www.pnas.org/content/pnas/115/19/4863/F1.large.jpg' width="500"></p>
<blockquote><p>A–C) Surface-air annual (A) temperature, (B) specific humidity, and (C) relative humidity anomalies averaged from 40∘S to 40∘N and best-fit trends (1979–2016) over land (red solid lines and asterisks) and ocean (blue lines and asterisks). The best-fit trends in the land–ocean contrasts in temperature and specific humidity (δTL−δTO and δqL−δqO, respectively) are also plotted (black asterisks). Land values are from the HadISDH dataset (13, 14) and ocean values are from the ERA-Interim reanalysis (15). Ocean specific humidity anomalies are calculated assuming fixed climatological relative humidity (Materials and Methods). Also shown are land anomalies and associated trends (dashed lines and circles) estimated using the simple theory (Eqs. 2–4) and subsampled to the months and gridboxes for which HadISDH observations are available. Error bars on the trends indicate the 90% confidence intervals corrected to account for serial correlation (Materials and Methods).</p>
</blockquote>
<p>Byrne and O'Gorman (2018): Trends in continental temperature and humidity directly linked to ocean warming, PNAS 115 (19) 4863-4868, <a href="https://doi.org/10.1073/pnas.1722312115">https://doi.org/10.1073/pnas.1722312115</a></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Looking-at-land-ocean-warming-patterns-in-the-CESM">Looking at land-ocean warming patterns in the CESM<a class="anchor-link" href="#Looking-at-land-ocean-warming-patterns-in-the-CESM"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following repeats the calculation we already did of the Equilibrium Climate Sensitity (ECS) and Transient Climate Response (TCR):</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">casenames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">:</span> <span class="s1">&#39;cpl_1850_f19&#39;</span><span class="p">,</span>
             <span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">:</span> <span class="s1">&#39;cpl_CO2ramp_f19&#39;</span><span class="p">,</span>
             <span class="s1">&#39;som_control&#39;</span><span class="p">:</span> <span class="s1">&#39;som_1850_f19&#39;</span><span class="p">,</span>
             <span class="s1">&#39;som_2xCO2&#39;</span><span class="p">:</span>   <span class="s1">&#39;som_1850_2xCO2&#39;</span><span class="p">,</span>
            <span class="p">}</span>
<span class="c1"># The path to the THREDDS server, should work from anywhere</span>
<span class="n">basepath</span> <span class="o">=</span> <span class="s1">&#39;http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/&#39;</span>
<span class="c1"># For better performance if you can access the roselab_rit filesystem (e.g. from JupyterHub)</span>
<span class="c1">#basepath = &#39;/roselab_rit/cesm_archive/&#39;</span>
<span class="n">casepaths</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">casenames</span><span class="p">:</span>
    <span class="n">casepaths</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">basepath</span> <span class="o">+</span> <span class="n">casenames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/concatenated/&#39;</span>
    
<span class="c1"># make a dictionary of all the CAM atmosphere output</span>
<span class="n">atm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">casenames</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">casepaths</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="n">casenames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.cam.h0.nc&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Attempting to open the dataset &#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">atm</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/cpl_1850_f19/concatenated/cpl_1850_f19.cam.h0.nc
Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/cpl_CO2ramp_f19/concatenated/cpl_CO2ramp_f19.cam.h0.nc
Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/som_1850_f19/concatenated/som_1850_f19.cam.h0.nc
Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/som_1850_2xCO2/concatenated/som_1850_2xCO2.cam.h0.nc
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># extract the last 10 years from the slab ocean control simulation</span>
<span class="n">nyears_som</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># and the last 20 years from the coupled control</span>
<span class="n">nyears_cpl</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">clim_slice_som</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">nyears_som</span><span class="o">*</span><span class="mi">12</span><span class="p">),</span><span class="kc">None</span><span class="p">)</span>
<span class="n">clim_slice_cpl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">nyears_cpl</span><span class="o">*</span><span class="mi">12</span><span class="p">),</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Tmap_cpl_2x</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">TREFHT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">Tmap_cpl_control</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">TREFHT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">DeltaTmap_cpl</span> <span class="o">=</span> <span class="n">Tmap_cpl_2x</span> <span class="o">-</span> <span class="n">Tmap_cpl_control</span>

<span class="n">Tmap_som_2x</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;som_2xCO2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">TREFHT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_som</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">Tmap_som_control</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;som_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">TREFHT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_som</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">DeltaTmap_som</span> <span class="o">=</span> <span class="n">Tmap_som_2x</span> <span class="o">-</span> <span class="n">Tmap_som_control</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_map</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;input field should be a 2D xarray.DataArray on a lat/lon grid.</span>
<span class="sd">        Make a filled contour plot of the field, and a line plot of the zonal mean</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">mapax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">())</span>
    <span class="n">barax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">),</span> <span class="p">(</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plotax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span><span class="n">ncols</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cx</span> <span class="o">=</span> <span class="n">mapax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">mapax</span><span class="o">.</span><span class="n">set_global</span><span class="p">();</span> <span class="n">mapax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">();</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">barax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
    <span class="n">plotax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">field</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
    <span class="n">plotax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
    <span class="n">plotax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">mapax</span><span class="p">,</span> <span class="n">plotax</span><span class="p">,</span> <span class="n">barax</span><span class="p">),</span> <span class="n">cx</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">make_map</span><span class="p">(</span><span class="n">DeltaTmap_cpl</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Surface air temperature anomaly (coupled transient)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># ensure the line plots have same axes</span>
<span class="n">cx</span><span class="o">.</span><span class="n">set_clim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>    <span class="c1"># ensure the contour maps have the same color intervals</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span><span class="n">cx</span>  <span class="o">=</span> <span class="n">make_map</span><span class="p">(</span><span class="n">DeltaTmap_som</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Surface air temperature anomaly (equilibrium SOM)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">cx</span><span class="o">.</span><span class="n">set_clim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_12_0.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_12_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">global_mean</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">atm</span><span class="p">[</span><span class="s1">&#39;som_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gw</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return the area-weighted global average of the input field&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">field</span><span class="o">*</span><span class="n">weight</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span><span class="o">/</span><span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>

<span class="n">ECS</span> <span class="o">=</span> <span class="n">global_mean</span><span class="p">(</span><span class="n">DeltaTmap_som</span><span class="p">)</span>
<span class="n">TCR</span> <span class="o">=</span> <span class="n">global_mean</span><span class="p">(</span><span class="n">DeltaTmap_cpl</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Equilibrium Climate Sensitivity is </span><span class="si">{:.3}</span><span class="s1"> K.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ECS</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The Transient Climate Response is </span><span class="si">{:.3}</span><span class="s1"> K.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">TCR</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The Equilibrium Climate Sensitivity is 2.89 K.
The Transient Climate Response is 1.67 K.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Make a map like Gavin&#39;s...  places where warming is &gt; global average</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">DeltaTmap_cpl</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">DeltaTmap_cpl</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> 
             <span class="n">DeltaTmap_cpl</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">DeltaTmap_cpl</span><span class="o">&gt;</span><span class="n">TCR</span><span class="p">),</span> 
             <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;#81090A&#39;</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Coupled transient (TCR = </span><span class="si">{:.3}</span><span class="s1"> K)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">TCR</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">())</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">DeltaTmap_som</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">DeltaTmap_som</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> 
             <span class="n">DeltaTmap_som</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">DeltaTmap_som</span><span class="o">&gt;</span><span class="n">ECS</span><span class="p">),</span> 
             <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;#81090A&#39;</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Equilibrium SOM (ECS = </span><span class="si">{:.3}</span><span class="s1"> K)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ECS</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">();</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Places that warm more than the global mean in CESM simulations&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 0.98, &#39;Places that warm more than the global mean in CESM simulations&#39;)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_14_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Key-Point">Key Point<a class="anchor-link" href="#Key-Point"> </a></h2><p>The <strong>enhanced warming over land</strong> is not just a feature of the transient, but is also found in the equilibrium response!</p>
<p>We cannot understand this result solely in terms of heat capacity differences.</p>
<p><strong>This motivates some detailed study of surface processes and the climatic coupling between land and ocean.</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plot-the-&quot;land-amplification-factor&quot;">Plot the "land amplification factor"<a class="anchor-link" href="#Plot-the-&quot;land-amplification-factor&quot;"> </a></h2><p>Plot the time average warming over land <strong>per unit zonally averaged warming of the surrounding oceans</strong></p>
$$A \equiv \frac{\delta T_L}{\delta T_O} $$<p>where $\delta T_L$ is the near-surface air temperature increase <strong>over land</strong>, and $\delta T_O$ is the <strong>zonally averaged</strong> near-surface air temperature increase <strong>over ocean</strong>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#  The land-ocean mask ... same for all simulations</span>
<span class="n">landfrac</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">LANDFRAC</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Zonally averaged ocean warming</span>
<span class="n">DeltaTO_cpl</span> <span class="o">=</span> <span class="n">DeltaTmap_cpl</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
<span class="n">DeltaTO_som</span> <span class="o">=</span> <span class="n">DeltaTmap_som</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>

<span class="n">land_amplification_cpl</span> <span class="o">=</span> <span class="n">DeltaTmap_cpl</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">DeltaTO_cpl</span>
<span class="n">land_amplification_som</span> <span class="o">=</span> <span class="n">DeltaTmap_som</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">DeltaTO_som</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">make_map</span><span class="p">(</span><span class="n">land_amplification_cpl</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Land warming amplification factor (coupled transient)&#39;</span><span class="p">);</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># ensure the line plots have same axes</span>
<span class="n">cx</span><span class="o">.</span><span class="n">set_clim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>    <span class="c1"># ensure the contour maps have the same color intervals</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">make_map</span><span class="p">(</span><span class="n">land_amplification_som</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Land warming amplification factor (equilibrium SOM)&#39;</span><span class="p">);</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># ensure the line plots have same axes</span>
<span class="n">cx</span><span class="o">.</span><span class="n">set_clim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>    <span class="c1"># ensure the contour maps have the same color intervals</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/br546577/anaconda3/envs/climlab-courseware/lib/python3.7/site-packages/xarray/core/nanops.py:159: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis=axis, dtype=dtype)
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_18_1.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_18_2.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-simple-theory-for-land-ocean-warming-contrast">A simple theory for land-ocean warming contrast<a class="anchor-link" href="#A-simple-theory-for-land-ocean-warming-contrast"> </a></h2><p>This section is based on a series of papers by Byrne and O'Gorman:</p>
<ul>
<li>Byrne and O'Gorman (2013): Land–Ocean Warming Contrast over a Wide Range of Climates: Convective Quasi-Equilibrium Theory and Idealized Simulations. J. Clim. 26, <a href="https://journals.ametsoc.org/doi/full/10.1175/JCLI-D-12-00262.1">https://journals.ametsoc.org/doi/full/10.1175/JCLI-D-12-00262.1</a></li>
<li>Byrne and O'Gorman (2016): Understanding Decreases in Land Relative Humidity with Global Warming: Conceptual Model and GCM Simulations. J. Clim. 29, <a href="https://journals.ametsoc.org/doi/10.1175/JCLI-D-16-0351.1">https://journals.ametsoc.org/doi/10.1175/JCLI-D-16-0351.1</a></li>
<li>Byrne and O'Gorman (2018): Trends in continental temperature and humidity directly linked to ocean warming, PNAS 115 (19) 4863-4868, <a href="https://doi.org/10.1073/pnas.1722312115">https://doi.org/10.1073/pnas.1722312115</a></li>
</ul>
<h3 id="The-atmospheric-dynamics-constraint">The atmospheric dynamics constraint<a class="anchor-link" href="#The-atmospheric-dynamics-constraint"> </a></h3><p>The dynamical argument has a few components:</p>
<ul>
<li>Frequent moist convection maintains a nearly moist-neutral lapse rate in the convectively active equatorial regions ("convective quasi-equilibrium").</li>
<li>"Weak Temperature Gradient" theory for the low-latitude atmosphere asserts that air temperatures in the free troposphere are nearly homogeneous.</li>
<li>Therefore the free troposphere is moist adiabatic everywhere.</li>
<li>The differences between surface air temperature over land and ocean can be expressed in terms of different Lifting Condensation Levels (LCL):</li>
</ul>
<p><img src='https://journals.ametsoc.org/na101/home/literatum/publisher/ams/journals/content/clim/2013/15200442-26.12/jcli-d-12-00262.1/20130609/images/large/jcli-d-12-00262.1-f1.jpeg' width="300"></p>
<blockquote><p>Fig. 1. Schematic diagram of potential temperature vs height for moist adiabats over land and ocean and equal temperatures at upper levels. A land–ocean surface air temperature contrast is implied by different LCLs over land and ocean.</p>
<p>Byrne and O'Gorman (2013) J. Clim. 26, <a href="https://journals.ametsoc.org/doi/full/10.1175/JCLI-D-12-00262.1">https://journals.ametsoc.org/doi/full/10.1175/JCLI-D-12-00262.1</a></p>
</blockquote>
<p>A consequence of these constraints is that, under a climate change, the near-surface <strong>moist static energy</strong> content over land and ocean are equal:</p>
$$ \delta h_L = \delta h_O $$<p>with the following standard notation:</p>
<ul>
<li>$h = c_p T + L_v q + g z_g$ is the moist static energy per unit mass</li>
<li>$T$ is air temperature</li>
<li>$q$ is the specific humidity</li>
<li>$z_g$ is the geopotential height</li>
</ul>
<p>From this we can infer that the <strong>land warming amplification factor</strong> is related to differences in boundary layer moistening:</p>
$$ A \equiv \frac{\delta T_L}{\delta T_O} = 1 + \frac{L_v}{c_p} \frac{\delta q_O - \delta q_L}{\delta T_O} $$<p>which implies that there will be <strong>greater warming over land than ocean</strong> so long as <em>the moistening rate with warming over ocean is greater than over land</em>, $\delta q_O &gt; \delta q_L$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-surface-moisture-constraint">The surface moisture constraint<a class="anchor-link" href="#The-surface-moisture-constraint"> </a></h3><p>This section is drawn directly from Byrne and O'Gorman (2016) J. Clim. 29, <a href="https://journals.ametsoc.org/doi/10.1175/JCLI-D-16-0351.1">https://journals.ametsoc.org/doi/10.1175/JCLI-D-16-0351.1</a></p>
<p>Consider the following simple moisture budgets for the boundary layers over ocean and over land:</p>
<p><img src='https://journals.ametsoc.org/na101/home/literatum/publisher/ams/journals/content/clim/2016/15200442-29.24/jcli-d-16-0351.1/20161201/images/large/jcli-d-16-0351.1-f2.jpeg' width="500"></p>
<blockquote><p>Fig. 2. Schematic diagram of processes involved in the moisture budget of the boundary layer above a land surface [see text and (1) for definitions of the various quantities].</p>
</blockquote>
<p>The budget over land is</p>
$$ l h_L \frac{d q_L}{dt} = h_O v_1 (q_O - q_L) + (h_L - h_O) v_1 (q_{FT,O} - q_L) + l v_2 (q_{FT,L} - q_L ) + \frac{1}{\rho_a} E_L $$<p>where</p>
<ul>
<li>$l$ is the horizontal length scale of the land</li>
<li>$h_L, h_O$ are the boundary layer depths</li>
<li>$v_1, v_2$ are the horizontal and vertical mixing velocities</li>
<li>$q_{FT,L}, q_{FT,O}$ are the free-tropospheric specific humidities above the boundary layers</li>
<li>$\rho_a$ is the density of air</li>
<li>$E_L$ is the evapotranspiration from the land surface</li>
</ul>
<p>The source terms on the RHS are respectively horizontal mixing of boundary layer air, horizontal mixing of free-tropospheric air, vertical mixing, and surface fluxes.</p>
<p>Now assume that free-tropospheric moisture is proportional to boundary layer moisture:</p>
\begin{align*}
q_{FT,L} &amp;= \lambda_L q_L  &amp;  q_{FT,O} &amp;= \lambda_O q_O
\end{align*}<p>Setting the LHS of the moisture budget to zero, we can solve the steady-state budget for land specific humidity $q_L$:</p>
$$ q_L = \frac{\left[ h_O + \lambda_O ( h_L - h_O)\right] \tau_2}{h_L\left[\tau_1(1-\lambda_L) + \tau_2 \right]} q_O + \frac{\tau_1 \tau_2 }{\rho_a h_L \left[ \tau_1(1-\lambda_L) + \tau_2 \right]} E_L $$<p>where for convenience we have defined horizontal and vertical mixing timescales</p>
\begin{align*}
\tau_1 &amp;= \frac{l}{v_1}  &amp;  \tau_2 &amp;= \frac{h_L}{v_2} 
\end{align*}<p>The two terms above quantify the relative importance of remote ocean specific humidity and local evapotransipiration on land specific humidity. We can rewrite this as</p>
$$ q_L = \gamma q_O + q_E $$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-&quot;Ocean-influence&quot;-box-model">The "Ocean-influence" box model<a class="anchor-link" href="#The-&quot;Ocean-influence&quot;-box-model"> </a></h3><p>The simplest form of the moisture constraint comes from assuming that the influence of evapotranspiration on boundary layer specific humidity over land is negligible.</p>
<p>Setting $E_L = 0$ we get simply</p>
$$ q_L = \gamma q_O$$<p>where the proportionality is</p>
$$\gamma = \frac{\left[ h_O + \lambda_O ( h_L - h_O)\right] \tau_2}{h_L\left[\tau_1(1-\lambda_L) + \tau_2 \right]} $$<p>We now make one more assumption: the proportionality $\gamma$ remains constant under climate change. Then changes in boundary specific humidity are related through</p>
$$\delta q_L = \gamma \delta q_O $$<p>where the constant can be evaluated from the reference climate:</p>
$$ \gamma = \frac{\overline{q_L}}{\overline{q_O}} $$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Combined-theory:-dynamic-and-moisture-constraints">Combined theory: dynamic and moisture constraints<a class="anchor-link" href="#Combined-theory:-dynamic-and-moisture-constraints"> </a></h3><p>Combining the dynamic and moisture constraints gives the change in land warming amplification factor *<em>solely in terms of the ocean warming and moistening</em>:</p>
$$ A \equiv \frac{\delta T_L}{\delta T_O}  = 1 + \frac{L_v}{c_p} (1-\gamma) \frac{\delta q_O}{\delta T_O} $$<p>which implies that there will be <strong>greater warming over land than ocean</strong> so long as the land surface is drier than the ocean surface ($\gamma &lt; 1$) and the air gets moister with warming over the ocean ($\delta q_O &gt; 0$).</p>
<p>Notice that with the combined constraints we are able to make this prediction without using an information about the land surface conditions other than the reference specific humidity (parameter $\gamma$).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Relative-humidity-changes-over-land">Relative humidity changes over land<a class="anchor-link" href="#Relative-humidity-changes-over-land"> </a></h3><p>The <strong>relative humidity</strong> is well approximated by</p>
$$ r = \frac{q}{q^*} $$<p>(over land or ocean) where $q^*$ is the relevant <strong>saturation</strong> specific humidity.</p>
<p>For small climate changes we can thus write <em>fractional</em> changes in relative humidity as</p>
$$ \frac{\delta r}{r} \approx \frac{\delta q}{q} - \frac{\delta q^*}{q^*}$$<p>and the fractional change in saturation is governed by the Clausius-Clapeyron relation, which is well approximated by</p>
$$ \frac{\delta q^*}{q^*} \approx \alpha \delta T $$<p>with the CC rate</p>
$$ \alpha = \frac{L_v}{R_v T^2} \approx 6 \% / K $$<p>We typically assume that <strong>relative humidity remains constant over the ocean</strong>, so $\frac{\delta r_O}{r_O} = 0$ and thus</p>
$$\frac{\delta q_O}{q_O} = \alpha \delta T_O $$<p>while over land we find instead</p>
$$ \frac{\delta r_L}{r_L} \approx \frac{\delta q_L}{q_L} - \alpha \delta T_L $$<p>An implication of the moisture constraint above is that the <strong>fractional</strong> changes in specific humidity must be the same over land and ocean:</p>
$$ \frac{\delta q_L}{q_L} = \frac{\delta q_O}{q_O} = \alpha \delta T_O $$<p>Combining this with the dynamic constraint then gives</p>
$$ \frac{\delta r_L}{r_L} \approx - \alpha (1-\gamma) \frac{L_v}{c_p} \delta q_O $$<p>The conclusion is that <strong>the relative humidity over land must decrease</strong> along with the amplified warming over land.</p>
<p>See Byrne and O'Gorman (2016) for discussion and caveats.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluation-of-simple-land-amplification-theory">Evaluation of simple land amplification theory<a class="anchor-link" href="#Evaluation-of-simple-land-amplification-theory"> </a></h2><p>To summarize the above derivations:</p>
<ol>
<li>The dynamic constraint gives the amplification factor $A$ as</li>
</ol>
$$ A \equiv \frac{\delta T_L}{\delta T_O} = 1 + \frac{L_v}{c_p} \frac{\delta q_O - \delta q_L}{\delta T_O} $$<p>while</p>
<ol>
<li>the moisture constraint (in its simplest form) gives</li>
</ol>
\begin{align*}
\delta q_L &amp;= \gamma \delta q_O  \\
\gamma &amp;= \frac{\overline{q_L}}{\overline{q_O}}
\end{align*}<p>so that the amplification factor is simply
$$ A = 1 + \frac{L_v}{c_p} (1-\gamma) \frac{\delta q_O}{\delta T_O} $$</p>
<p>We are going to evaluate this theory quantitatively against the CESM simulations.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">climlab.utils.constants</span> <span class="kn">import</span> <span class="n">Lhvap</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">Rv</span>

<span class="k">def</span> <span class="nf">land_amp</span><span class="p">(</span><span class="n">deltaQO</span><span class="p">,</span> <span class="n">deltaQL</span><span class="p">,</span> <span class="n">deltaTO</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">Lhvap</span><span class="o">/</span><span class="n">cp</span><span class="o">*</span><span class="p">(</span><span class="n">deltaQO</span> <span class="o">-</span> <span class="n">deltaQL</span><span class="p">)</span><span class="o">/</span><span class="n">deltaTO</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Look at zonally averaged specific humidity over land and ocean</span>
<span class="n">qL</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">))</span>
<span class="n">qO</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">))</span>

<span class="n">qO</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ocean&#39;</span><span class="p">)</span>
<span class="n">qL</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Land&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Specific humidity (kg/kg)&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/br546577/anaconda3/envs/climlab-courseware/lib/python3.7/site-packages/xarray/core/nanops.py:159: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis=axis, dtype=dtype)
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_26_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Amplification-factors-using-dynamic-constraint-only">Amplification factors using dynamic constraint only<a class="anchor-link" href="#Amplification-factors-using-dynamic-constraint-only"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#  Compute changes in specific humidity</span>
<span class="n">Qmap_cpl_2x</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">Qmap_cpl_control</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">DeltaQmap_cpl</span> <span class="o">=</span> <span class="n">Qmap_cpl_2x</span> <span class="o">-</span> <span class="n">Qmap_cpl_control</span>

<span class="n">Qmap_som_2x</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;som_2xCO2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_som</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">Qmap_som_control</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;som_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_som</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">DeltaQmap_som</span> <span class="o">=</span> <span class="n">Qmap_som_2x</span> <span class="o">-</span> <span class="n">Qmap_som_control</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Increase in specific humidity over oceans per degree warming</span>
<span class="n">DeltaQO_cpl</span> <span class="o">=</span> <span class="n">DeltaQmap_cpl</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
<span class="n">DeltaQO_som</span> <span class="o">=</span> <span class="n">DeltaQmap_som</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">DeltaQO_cpl</span> <span class="o">/</span> <span class="n">DeltaTO_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;coupled transient&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">DeltaQO_som</span> <span class="o">/</span> <span class="n">DeltaTO_som</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;equilibrium SOM&#39;</span><span class="p">)</span>
<span class="c1"># Simple estimate of the moistening rate from Clausius-Clapeyron</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">Lhvap</span><span class="o">/</span><span class="n">Rv</span><span class="o">/</span><span class="mi">288</span><span class="o">**</span><span class="mi">2</span>
<span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">qO</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Clausius-Clapeyron moistening rate&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;kg/kg/K&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;kg/kg/K&#39;)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_29_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the normalized humidity increase is nearly identical in the two models, and very well predicted by Clausius-Clapeyron.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compute the land amplification factor based on dynamic constraint only</span>
<span class="c1">#  Note that this requires knowledge of actual specific humidity changes over land</span>

<span class="n">predicted_land_amplification_cpl</span> <span class="o">=</span> <span class="n">land_amp</span><span class="p">(</span><span class="n">DeltaQO_cpl</span><span class="p">,</span> <span class="n">DeltaQmap_cpl</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">DeltaTO_cpl</span><span class="p">)</span>
<span class="n">predicted_land_amplification_som</span> <span class="o">=</span> <span class="n">land_amp</span><span class="p">(</span><span class="n">DeltaQO_som</span><span class="p">,</span> <span class="n">DeltaQmap_som</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">DeltaTO_som</span><span class="p">)</span>

<span class="n">make_map</span><span class="p">(</span><span class="n">predicted_land_amplification_cpl</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;PREDICTED land amplification factor (dynamic constraint only - coupled transient)&#39;</span><span class="p">);</span>
<span class="n">make_map</span><span class="p">(</span><span class="n">predicted_land_amplification_som</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;PREDICTED land amplification factor (dynamic constraint only - equilibrium SOM)&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_31_0.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_31_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Amplification-factors-using-dynamic-+-moisture-constraint">Amplification factors using dynamic + moisture constraint<a class="anchor-link" href="#Amplification-factors-using-dynamic-+-moisture-constraint"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Make a map of the &quot;gamma&quot; factor, ratio of land specific humidity to surrounding oceans</span>
<span class="n">qL_map</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
<span class="n">gamma_map</span> <span class="o">=</span> <span class="n">qL_map</span> <span class="o">/</span> <span class="n">qO</span>
<span class="n">make_map</span><span class="p">(</span><span class="n">gamma_map</span><span class="p">,</span> <span class="s1">&#39;Relative dryness of land surface compared to oceans, $\gamma = q_L / q_O$&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_33_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predicted_land_amplification_simple</span> <span class="o">=</span> <span class="n">land_amp</span><span class="p">(</span><span class="n">DeltaQO_cpl</span><span class="p">,</span> <span class="n">gamma_map</span><span class="o">*</span><span class="n">DeltaQO_cpl</span><span class="p">,</span> <span class="n">DeltaTO_cpl</span><span class="p">)</span>
<span class="n">make_map</span><span class="p">(</span><span class="n">predicted_land_amplification_simple</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;PREDICTED Land warming amplification factor (dynamic+moisture constraints)&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_34_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Summarize the zonal average results (Plot coupled model only)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">land_amplification_cpl</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulated&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">predicted_land_amplification_cpl</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dynamic constraint theory&#39;</span><span class="p">,</span> 
                                                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">predicted_land_amplification_simple</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Combined theory&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_35_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compare to CMIP5 multi-model mean:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src='https://journals.ametsoc.org/na101/home/literatum/publisher/ams/journals/content/clim/2016/15200442-29.24/jcli-d-16-0351.1/20161201/images/large/jcli-d-16-0351.1-fa1.jpeg' width="400"></p>
<blockquote><p>Fig. B1. The CMIP5 multimodel mean (a) land–ocean warming contrast (expressed as an amplification factor) and (b) surface-air land pseudo relative humidity change normalized by the global-mean surface-air temperature change (solid lines) and as estimated by the combined moisture and dynamic constraints (dashed lines). The amplification factor and land relative humidity changes are estimated for each land grid point and for each month of the year before taking the zonal and annual means.</p>
</blockquote>
<p>Byrne and O'Gorman (2016) J. Clim. 29, <a href="https://journals.ametsoc.org/doi/10.1175/JCLI-D-16-0351.1">https://journals.ametsoc.org/doi/10.1175/JCLI-D-16-0351.1</a></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our results are consistent with Byrne and O'Gorman in that the simple theory captures the amplification signal in the <strong>southern subtropics</strong> quite well, but strongly overestimates the amplifcation in the <strong>northern subtropics</strong>.</p>
<p>The simple "ocean influence" theory works best in the hemisphere dominated by ocean!</p>
<p>We may get more insight into the weaknesses of the theory by looking more carefully at the relative humidity changes, and the role of land-surface evaporation changes (neglected under the "ocean-influence" theory).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Critical-evaluation-of-assumptions">Critical evaluation of assumptions<a class="anchor-link" href="#Critical-evaluation-of-assumptions"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Recompute gamma for the warmer climate.</span>
<span class="c1"># We assumed it did not change with global warming</span>

<span class="c1"># Look at zonally averaged specific humidity over land and ocean</span>
<span class="n">qL_2x</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">))</span>
<span class="n">qO_2x</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">))</span>

<span class="c1"># Make a map of the &quot;gamma&quot; factor, ratio of land specific humidity to surrounding oceans</span>
<span class="n">qL_map_2x</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">QREFHT</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">landfrac</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
<span class="n">gamma_map_2x</span> <span class="o">=</span> <span class="n">qL_map_2x</span> <span class="o">/</span> <span class="n">qO_2x</span>
<span class="n">make_map</span><span class="p">(</span><span class="n">gamma_map_2x</span><span class="p">,</span> <span class="s1">&#39;Relative dryness of land surface compared to oceans (2x CO2), $\gamma = q_L / q_O$&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_40_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Plot the percentage change</span>
<span class="n">make_map</span><span class="p">((</span><span class="n">gamma_map_2x</span><span class="o">-</span><span class="n">gamma_map</span><span class="p">)</span><span class="o">/</span><span class="n">gamma_map</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Percent change in gamma&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_41_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The error is pretty small.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Relative-humidity-change">Relative humidity change<a class="anchor-link" href="#Relative-humidity-change"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">RHmap</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">RELHUM</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lev</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">RHmap_2x</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">RELHUM</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lev</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">DeltaRHmap</span> <span class="o">=</span> <span class="n">RHmap_2x</span> <span class="o">-</span> <span class="n">RHmap</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">make_map</span><span class="p">(</span><span class="n">RHmap</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Control relative humidity&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_45_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">make_map</span><span class="p">(</span><span class="n">DeltaRHmap</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Relative humidity change (transient coupled)&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/courseware/Lecture24_46_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looks like a big source of error in the simple estimates of land amplification here is the unexpected relative moistening over the arid regions of North Africa and Arabia.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Version-information">Version information<a class="anchor-link" href="#Version-information"> </a></h2><hr>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> version_information
<span class="o">%</span><span class="k">version_information</span> numpy, matplotlib, xarray, cartopy, climlab
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loading extensions from ~/.ipython/extensions is deprecated. We recommend managing extensions like any other Python packages, in site-packages.
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<table><tr><th>Software</th><th>Version</th></tr><tr><td>Python</td><td>3.7.3 64bit [Clang 4.0.1 (tags/RELEASE_401/final)]</td></tr><tr><td>IPython</td><td>7.6.0</td></tr><tr><td>OS</td><td>Darwin 17.7.0 x86_64 i386 64bit</td></tr><tr><td>numpy</td><td>1.16.4</td></tr><tr><td>matplotlib</td><td>3.1.1</td></tr><tr><td>xarray</td><td>0.12.1</td></tr><tr><td>cartopy</td><td>0.17.0</td></tr><tr><td>climlab</td><td>0.7.5</td></tr><tr><td colspan='2'>Wed Jul 03 14:58:44 2019 EDT</td></tr></table>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Credits">Credits<a class="anchor-link" href="#Credits"> </a></h2><p>The author of this notebook is <a href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<p>It was developed in support of <a href="http://www.atmos.albany.edu/facstaff/brose/classes/ATM623_Spring2015/">ATM 623: Climate Modeling</a>, a graduate-level course in the <a href="http://www.albany.edu/atmos/index.php">Department of Atmospheric and Envionmental Sciences</a></p>
<p>Development of these notes and the <a href="https://github.com/brian-rose/climlab">climlab software</a> is partially supported by the National Science Foundation under award AGS-1455071 to Brian Rose. Any opinions, findings, conclusions or recommendations expressed here are mine and do not necessarily reflect the views of the National Science Foundation.</p>
<hr>

</div>
</div>
</div>
</div>

 


    </main>
    